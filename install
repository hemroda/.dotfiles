if [[ "$OSTYPE" == "linux-gnu"* ]]; then
  echo "Setting up KALI"
  echo "---------------------"

  sudo apt install stow
  sudo apt install libpq-dev
  wget -qO- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash
  # postgresql
  sudo apt install postgresql -y
  sudo systemctl start postgresql
  sudo systemctl status postgresql
  # redis
  sudo apt install redis-server
  sudo systemctl enable redis-server
  systemctl status redis-server
  # ripgrep
  curl -LO https://github.com/BurntSushi/ripgrep/releases/download/13.0.0/ripgrep_13.0.0_amd64.deb
  sudo dpkg -i ripgrep_13.0.0_amd64.deb
  rm -rf ripgrep_13.0.0_amd64.deb
  # rbenv
  git clone https://github.com/rbenv/rbenv.git ~/.rbenv
  cd ~/.rbenv && src/configure && make -C src

  # install cargo for rust based cli tools
  curl https://sh.rustup.rs -sSf | sh
  cargo install alacritty
  cargo install starship --locked
  cargo install bat --locked
  cargo install exa
  cargo install rm-improved
  cargo install xcp
else
  echo "Setting up your MACOS"
  echo "---------------------"

  echo "Installing Homebrew"
  ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
  eval "$(/opt/homebrew/bin/brew shellenv)"

  echo "Install ohmyzsh"
  sh -c "$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"

  echo "Installing Stow & co using Homebrew"
  echo "-----------------------------------"
  brew install stow
  brew install tmux
  brew install postgresql
  brew install imagemagick
  brew install vips
  brew install cmake
  brew install openssl
  brew install gpg
  brew install gawk
  brew install ripgrep
  brew install rbenv ruby-build
  brew install fzf
  brew install tree
  brew install redis
  brew install yarn
  brew install nvm
  brew install starship
  brew install bat
  brew install exa
  brew install rm-improved
  brew install pnpm
  brew install --cask docker
  brew install --cask 1password
  brew install --cask alacritty
  brew install --cask discord
  brew install --cask obsidian
  brew install --cask postman
  brew install --cask slack
  brew install --cask spotify
  brew install --cask brave-browser
  brew install --cask google-chrome
  brew install --cask homebrew/cask-versions/firefox-developer-edition
  brew tap homebrew/cask-fonts
  brew install --cask font-hack-nerd-font
  brew install --cask font-jetbrains-mono
  brew install --cask flux
  mkdir ~/.nvm
  mkdir ~/.vim

  brew services restart postgresql
  brew services start redis
fi

stow git
stow vim
mv ~/.zshrc ~/.zshrc_old
stow zsh
stow ruby
stow config
stow tmux

mkdir ~/Sites

sudo rbenv install 3.0.3
nvm install 16.13.1
